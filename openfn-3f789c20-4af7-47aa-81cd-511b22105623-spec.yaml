name: cht-sandbox
description: null
collections:
  run-logs:
    name: run-logs
credentials:
  mtuchi@openfn.org-DHIS2-2-40-7:
    name: DHIS2 2-40-7
    owner: mtuchi@openfn.org
  mtuchi@openfn.org-DHIS2-Dev:
    name: DHIS2 Dev
    owner: mtuchi@openfn.org
  rkenyuri@icrc.org-DHIS2-PLAY-dev-2-40:
    name: DHIS2 PLAY dev 2-40
    owner: rkenyuri@icrc.org
workflows:
  CHT-DHIS2:
    name: CHT-DHIS2
    jobs:
      OpenFn:
        name: OpenFn
        adaptor: '@openfn/language-common@latest'
        credential: null
        body:
          path: workflows/cht-dhis2/map-cht-submission.js

      Check-existing-events:
        name: Check existing events
        adaptor: '@openfn/language-dhis2@6.3.1'
        credential: rkenyuri@icrc.org-DHIS2-PLAY-dev-2-40
        body:
          path: workflows/cht-dhis2/check-events.js
      Create-Event:
        name: Create Event
        adaptor: '@openfn/language-dhis2@6.3.1'
        credential: rkenyuri@icrc.org-DHIS2-PLAY-dev-2-40
        body:
          path: workflows/cht-dhis2/create-event.js

    triggers:
      webhook:
        type: webhook
        enabled: true
    edges:
      webhook->OpenFn:
        source_trigger: webhook
        target_job: OpenFn
        condition_type: always
        enabled: true
      OpenFn->Check-existing-events:
        source_job: OpenFn
        target_job: Check-existing-events
        condition_type: on_job_success
        enabled: true
      Check-existing-events->Create-Event:
        source_job: Check-existing-events
        target_job: Create-Event
        condition_type: on_job_success
        enabled: true
  CHT-MatchSplit-Mapping:
    name: CHT-MatchSplit-Mapping
    jobs:
      Mappings:
        name: Mappings
        adaptor: '@openfn/language-common@latest'
        credential: null
        body:
          path: workflows/cht-matchsplit-mappings/mappings.js
    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Mappings:
        source_trigger: webhook
        target_job: Mappings
        condition_type: always
        enabled: true
  KOBO-Mpesa:
    name: KOBO-Mpesa
    jobs:
      Fetch-Submissions:
        name: Fetch Submissions
        adaptor: '@openfn/language-kobotoolbox@latest'
        credential: null
        body:
          path: workflows/kobo-mpesa/fetch-submissions.js
      Mpesa-request:
        name: Mpesa request
        adaptor: '@openfn/language-http@latest'
        credential: null
        body:
          path: workflows/kobo-mpesa/mpesa-request.js
    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->Fetch-Submissions:
        source_trigger: webhook
        target_job: Fetch-Submissions
        condition_type: always
        enabled: true
      Fetch-Submissions->Mpesa-request:
        source_job: Fetch-Submissions
        target_job: Mpesa-request
        condition_type: on_job_success
        enabled: true
  Old-CHT-DHIS2:
    name: Old-CHT-DHIS2
    jobs:
      DHIS2-mapping:
        name: DHIS2 mapping
        adaptor: '@openfn/language-common@2.3.0'
        credential: null
        body:
          path: workflows/old-cht-dhis2/mapping.js

      Create-Event-Program:
        name: Create Event Program
        adaptor: '@openfn/language-dhis2@6.1.0'
        credential: mtuchi@openfn.org-DHIS2-2-40-7
        body:
          path: workflows/old-cht-dhis2/create-event.js
    triggers:
      webhook:
        type: webhook
        enabled: false
    edges:
      webhook->DHIS2-mapping:
        source_trigger: webhook
        target_job: DHIS2-mapping
        condition_type: always
        enabled: true
      DHIS2-mapping->Create-Event-Program:
        source_job: DHIS2-mapping
        target_job: Create-Event-Program
        condition_type: on_job_success
        enabled: true
